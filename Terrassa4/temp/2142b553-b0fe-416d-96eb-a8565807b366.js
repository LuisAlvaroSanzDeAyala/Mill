var MADRID 		= "0";
var BARCELONA 	= "1";
var DESTINO1 	= "2";
var DESTINO2 	= "3";
var OTROS 		= "4";
var seg = ["MAD", "BCN", "DST1", "DST2", "OTROS" ];
var cpsD1 = ["01001", "01002", "01003", "01004","01005", "01006", "01007", "01008", "01009", "01010", "01012","01013", "01015", "01070", "01071", "01080", "02001", "02002","02003", "02004", "02005", "02006", "02007", "02049", "02070","02071", "02080", "03001", "03002", "03003", "03004", "03005","03006", "03007", "03008", "03009", "03010", "03011", "03012","03013", "03014", "03015", "03016", "03070", "03071", "03080","03200", "03201", "03202", "03203", "03204", "03205", "03206","03207", "03208", "04001", "04002", "04003", "04004", "04005","04006", "04007", "04008", "04009", "04070", "04071", "04080","05001", "05002", "05003", "05004", "05005", "05070", "05071","05080", "06001", "06002", "06003", "06004", "06005", "06006","06007", "06008", "06009", "06010", "06011", "06012", "06070","06071", "06080", "06800", "07001", "07002", "07003", "07004","07005", "07006", "07007", "07008", "07009", "07010", "07011","07012", "07013", "07014", "07015", "07070", "07071", "07080","07700", "07701", "07702", "07703", "07714", "07800", "07819","08001", "08002", "08003", "08004", "08005", "08006", "08007","08008", "08009", "08010", "08011", "08012", "08013", "08014","08015", "08016", "08017", "08018", "08019", "08020", "08021","08022", "08023", "08024", "08025", "08026", "08027", "08028","08029", "08030", "08031", "08032", "08033", "08034", "08035","08036", "08037", "08038", "08039", "08040", "08041", "08042","08070", "08071", "08080", "08100", "08104", "08161", "08191","08193", "08200", "08201", "08202", "08203", "08204", "08205","08206", "08207", "08208", "08220", "08221", "08222", "08223","08224", "08225", "08226", "08227", "08228", "08240", "08241","08242", "08243", "08248", "08290", "08300", "08301", "08302","08303", "08304", "08401", "08402", "08403", "08404", "08802","08805", "08820", "08830", "08840", "08900", "08901", "08902","08903", "08904", "08905", "08906", "08907", "08908", "08910","08911", "08912", "08913", "08914", "08915", "08916", "08917","08918", "08920", "08921", "08922", "08923", "08924", "08940","09001", "09002", "09003", "09004", "09005", "09006", "09007","09070", "09071", "09080", "10001", "10002", "10003", "10004","10005", "10070", "10071", "10080", "11001", "11002", "11003","11004", "11005", "11006", "11007", "11008", "11009", "11010","11011", "11012", "11070", "11071", "11080", "11100", "11110","11120", "11130", "11138", "11139", "11200", "11201", "11202","11203", "11204", "11205", "11206", "11207", "11270", "11271","11280", "11300", "11401", "11402", "11403", "11404", "11405","11406", "11407", "11408", "11471", "11480", "11500", "12001","12002", "12003", "12004", "12005", "12006", "12070", "12071","12080", "13001", "13002", "13003", "13004", "13005", "13070","13071", "13080", "13500", "14001", "14002", "14003", "14004","14005", "14006", "14007", "14008", "14009", "14010", "14011","14012", "14013", "14014", "14070", "14071", "14080", "15001","15002", "15003", "15004", "15005", "15006", "15007", "15008","15009", "15010", "15011", "15070", "15071", "15080", "15401","15402", "15403", "15404", "15405", "15406", "15470", "15471","15480", "15482", "15490", "15701", "15702", "15703", "15704","15705", "15706", "15707", "15770", "15771", "15780", "15781","15782", "16001", "16002", "16003", "16004", "16070", "16071","16080", "17001", "17002", "17003", "17004", "17005", "17006","17007", "17070", "17071", "17080", "18001", "18002", "18003","18004", "18005", "18006", "18007", "18008", "18009", "18010","18011", "18012", "18013", "18014", "18015", "18070", "18071","18080", "19001", "19002", "19003", "19004", "19005", "19070","19071", "19080", "20001", "20002", "20003", "20004", "20005","20006", "20007", "20008", "20009", "20010", "20011", "20012","20013", "20014", "20015", "20016", "20017", "20018", "20070","20071", "20080", "20300", "20301", "20302", "20303", "20304","20305", "21001", "21002", "21003", "21004", "21005", "21006","21007", "21070", "21071", "21080", "22001", "22002", "22003","22004", "22005", "22006", "22070", "22071", "22080", "23001","23002", "23003", "23004", "23005", "23006", "23007", "23008","23009", "23070", "23071", "23080", "23700", "24001", "24002","24003", "24004", "24005", "24006", "24007", "24008", "24009","24010", "24070", "24071", "24080", "25001", "25002", "25003","25004", "25005", "25006", "25007", "25008", "25070", "25071","25080", "26001", "26002", "26003", "26004", "26005", "26006","26007", "26008", "26009", "26070", "26071", "26080", "27001","27002", "27003", "27004", "27070", "27071", "27080", "28001","28002", "28003", "28004", "28005", "28006", "28007", "28008","28009", "28010", "28011", "28012", "28013", "28014", "28015","28016", "28017", "28018", "28019", "28020", "28021", "28022","28023", "28024", "28025", "28026", "28027", "28028", "28029","28030", "28031", "28032", "28033", "28034", "28035", "28036","28037", "28038", "28039", "28040", "28041", "28042", "28043","28044", "28045", "28046", "28047", "28048", "28049", "28050","28051", "28052", "28053", "28054", "28070", "28071", "28080","28082", "28083", "28085", "28086", "28087", "28100", "28108","28109", "28400", "28520", "28521", "28522", "28523", "28524","28800", "28801", "28802", "28803", "28804", "28805", "28806","28807", "28820", "28821", "28822", "28823", "28850", "28870","28900", "28901", "28902", "28903", "28904", "28905", "28906","28907", "28909", "28910", "28911", "28912", "28913", "28914","28915", "28916", "28917", "28918", "28919", "28920", "28921","28922", "28923", "28924", "28925", "28930", "28931", "28932","28933", "28934", "28935", "28936", "28937", "28938", "28940","28941", "28942", "28943", "28944", "28945", "28946", "28947","28980", "28981", "28982", "28983", "28984", "29001", "29002","29003", "29004", "29005", "29006", "29007", "29008", "29009","29010", "29011", "29012", "29013", "29014", "29015", "29016","29017", "29018", "29070", "29071", "29080", "29620", "29640","30001", "30002", "30003", "30004", "30005", "30006", "30007","30008", "30009", "30010", "30011", "30012", "30070", "30071","30080", "30200", "30201", "30202", "30203", "30204", "30205","31001", "31002", "31003", "31004", "31005", "31006", "31007","31008", "31009", "31010", "31011", "31012", "31013", "31014","31015", "31016", "31070", "31071", "31080", "32001", "32002","32003", "32004", "32005", "32070", "32071", "32080", "33001","33002", "33003", "33004", "33005", "33006", "33007", "33008","33009", "33010", "33011", "33012", "33013", "33070", "33071","33080", "33200", "33201", "33202", "33203", "33204", "33205","33206", "33207", "33208", "33209", "33210", "33211", "33212","33213", "33290", "33299", "34001", "34002", "34003", "34004","34005", "34006", "34070", "34071", "34080", "35001", "35002","35003", "35004", "35005", "35006", "35007", "35008", "35009","35010", "35011", "35012", "35013", "35014", "35015", "35016","35017", "35018", "35019", "35070", "35071", "35080", "36001","36002", "36003", "36004", "36005", "36070", "36071", "36080","36200", "36201", "36202", "36203", "36204", "36205", "36206","36207", "36208", "36209", "36210", "36211", "36212", "36213","36214", "36215", "36216", "37001", "37002", "37003", "37004","37005", "37006", "37007", "37008", "37070", "37071", "37080","38001", "38002", "38003", "38004", "38005", "38006", "38007","38008", "38009", "38010", "38070", "38071", "38080", "38200","38201", "38202", "38203", "38204", "38205", "38206", "38207","38208", "38291", "38293", "38295", "38296", "38297", "39001","39002", "39003", "39004", "39005", "39006", "39007", "39008","39009", "39010", "39011", "39012", "39070", "39071", "39080","39300", "39315", "40001", "40002", "40003", "40004", "40005","40006", "40070", "40071", "40080", "41001", "41002", "41003","41004", "41005", "41006", "41007", "41008", "41009", "41010","41011", "41012", "41013", "41014", "41015", "41016", "41017","41018", "41019", "41020", "41070", "41071", "41080", "41089","41092", "41500", "41700", "41701", "41702", "41703", "41704","42001", "42002", "42003", "42004", "42005", "42070", "42071","42080", "43001", "43002", "43003", "43004", "43005", "43006","43007", "43008", "43070", "43071", "43080", "43200", "43201","43202", "43203", "43204", "43205", "43206", "44001", "44002","44003", "44070", "44071", "44080", "45001", "45002", "45003","45004", "45005", "45006", "45007", "45008", "45009", "45070","45071", "45080", "45600", "45613", "45614", "45694", "46001","46002", "46003", "46004", "46005", "46006", "46007", "46008","46009", "46010", "46011", "46012", "46013", "46014", "46015","46016", "46017", "46018", "46019", "46020", "46021", "46022","46023", "46024", "46025", "46026", "46035", "46070", "46071","46080", "47001", "47002", "47003", "47004", "47005", "47006","47007", "47008", "47009", "47010", "47011", "47012", "47013","47014", "47015", "47016", "47070", "47071", "47080", "48001","48002", "48003", "48004", "48005", "48006", "48007", "48008","48009", "48010", "48011", "48012", "48013", "48014", "48015","48070", "48071", "48080", "48900", "48901", "48902", "48903","48930", "48990", "48991", "48992", "48993", "49001", "49002","49003", "49004", "49005", "49006", "49007", "49008", "49009","49010", "49011", "49012", "49013", "49014", "49015", "49016","49017", "49018", "49019", "49020", "49021", "49022", "49023","49024", "49025", "49026", "49027", "49028", "49029", "49030","49031", "49032", "49070", "49071", "49080", "50001", "50002","50003", "50004", "50005", "50006", "50007", "50008", "50009","50010", "50011", "50012", "50013", "50014", "50015", "50016","50017", "50018", "50059", "50070", "50071", "50080", "50090","51001", "51002", "51003", "51004", "51005", "51070", "51071","51080", "52000", "52001", "52002", "52003", "52004", "52005","52006", "52070", "52071", "52080" ];
try {
	fileVariables.VarZonaPostal = resuelveCP(fileVariables.UserCP);
	fileVariables.UserProvincia = dameProvincia(fileVariables.UserCP);	
} catch (e) {logger.error("No se ha podido ejecutar la asignación de Codigo Postal correctamente");}
function resuelveCP(cp) {
	if (!esCP(cp))				{return OTROS;}
	if (cp.startsWith("080"))	{return BARCELONA;}
	if (cp.startsWith("280"))	{return MADRID;}		
	var inicio = 0;
	var fin = cpsD1.length - 1;
	var aux = parseInt((cpsD1.length / 2).toFixed());
	while (cpsD1[aux] != cp && inicio != aux && fin != aux) {
		if(cp.localeCompare(cpsD1[aux]) < 0) {
			fin = aux;
		}else{inicio = aux;}
		aux = parseInt(((parseInt(fin) - parseInt(inicio)) / 2).toFixed()) + parseInt(inicio);
	}
	if (cpsD1[inicio] == cp || cpsD1[aux] == cp || cpsD1[fin] == cp) {return DESTINO1;}
	return DESTINO2;
}
function dameProvincia(cp) {
	while (cp.length < 5)
		cp = "0" + cp;	
	var iCP = parseInt(cp.substring(0, 2),10);
	fileVariables.UserProvincia = iCP;
	switch (iCP) {
	case 1: return "ÁLAVA";			case 2: return "ALBACETE";	case 3: return "ALICANTE";		case 4: return "ALMERÍA";
	case 5: return "ÁVILA";			case 6: return "BADAJOZ";	case 7: return "ILLES BALEARS";	case 8: return "BARCELONA";
	case 9: return "BURGOS";		case 10: return "CÁCERES";	case 11: return "CÁDIZ";		case 12: return "CASTELLÓN";
	case 13: return "CIUDAD REAL";	case 14: return "CÓRDOBA";	case 15: return "A CORUÑA";		case 16: return "CUENCA";
	case 17: return "GIRONA";		case 18: return "GRANADA";	case 19: return "GUADALAJARA";	case 20: return "GUIPÚZCOA";
	case 21: return "HUELVA";		case 22: return "HUESCA";	case 23: return "JAÉN";			case 24: return "LEÓN";
	case 25: return "LLEIDA";		case 26: return "LA RIOJA";	case 27: return "LUGO";			case 28: return "MADRID";
	case 29: return "MÁLAGA";		case 30: return "MURCIA";	case 31: return "NAVARRA";		case 32: return "OURENSE";
	case 33: return "ASTURIAS";		case 34: return "PALENCIA";	case 35: return "LAS PALMAS";	case 36: return "PONTEVEDRA";
	case 37: return "SALAMANCA";	case 38: return "SANTA CRUZ DE TENERIFE";					case 39: return "CANTABRIA";
	case 40: return "SEGOVIA";		case 41: return "SEVILLA";	case 42: return "SORIA";		case 43: return "TARRAGONA";
	case 44: return "TERUEL";		case 45: return "TOLEDO";	case 46: return "VALENCIA";		case 47: return "VALLADOLID";
	case 48: return "VIZCAYA";		case 49: return "ZAMORA";	case 50: return "ZARAGOZA";		case 51: return "CEUTA";
	case 52: return "MELILLA";		default: return "";
	}
}
function esCP(cp) {
	try{
		if (cp.length < 4 || cp.length > 5)
			return false;
		var CP;
		try{
			CP = parseInt(cp, 10);
			if (isNaN(CP))
				return false;
		}catch (e) {logger.error(e);}
		if (CP < 1000 || CP > 53000)
			return false;
		return true;
	}catch (e) {logger.error(e);}
}